<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자바스크립트 : 기본 규칙</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/dracula.css">
</head>

<body>
    <main id="main">
        <div class="document">
            <h2 class="t_tit">패럴랙스 이펙트</h2>
            <p class="t_desc2">
                패럴랙스 이펙트는 페이지에서 스크롤을 내림에따라 이미지가 보여지거나 애니메이션이 실행되는 등, 스크롤 값을 이용한 효과입니다.
            </p>
            <h3 class="t_tit2">HTML 코드</h3>
            <p class="t_desc">
                패럴랙스 이펙트와 관련된 HTML 부분입니다.
            </p>
            <details>
                <summary>HTML 보기</summary>
                <div class="t_code">
<pre><code class="language-js">&lt;nav id="parallax__nav">
    &lt;ul>
        &lt;li class="active">&lt;a href="#section01">메뉴1&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section02">메뉴2&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section03">메뉴3&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section04">메뉴4&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section05">메뉴5&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section06">메뉴6&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section07">메뉴7&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section08">메뉴8&lt;/a>&lt;/li>
        &lt;li>&lt;a href="#section09">메뉴9&lt;/a>&lt;/li>
    &lt;/ul>
&lt;/nav>
&lt;!-- parallax__nav -->

&lt;main id="parallax__cont">
    &lt;div id="contents">
        &lt;section id="section01" class="content__item">
            &lt;span class="content__item__num">01&lt;/span>
            &lt;h2 class="content__item__title">section1&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">질병은 입을 쫓아 들어가고 화근은 입을 좇아 나온다.&lt;/p>
        &lt;/section>
        &lt;!-- //section01 -->

        &lt;section id="section02" class="content__item">
            &lt;span class="content__item__num">02&lt;/span>
            &lt;h2 class="content__item__title">section2&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">지혜는 듣는 데서 오고 후회는 말하는 데서 온다.&lt;/p>
        &lt;/section>
        &lt;!-- //section02 -->
        
        &lt;section id="section03" class="content__item">
            &lt;span class="content__item__num">03&lt;/span>
            &lt;h2 class="content__item__title">section3&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">모든 날 중 가장 완전히 잃어버린 날은 웃지 않는 날이다.&lt;/p>
        &lt;/section>
        &lt;!-- //section03 -->
        
        &lt;section id="section04" class="content__item">
            &lt;span class="content__item__num">04&lt;/span>
            &lt;h2 class="content__item__title">section4&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">열의 없이 성취 된 위업이란 아직 하나도 없다.&lt;/p>
        &lt;/section>
        &lt;!-- //section04 -->
        
        &lt;section id="section05" class="content__item">
            &lt;span class="content__item__num">05&lt;/span>
            &lt;h2 class="content__item__title">section5&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">절제는 모든 진주 고리를 이어주는 비단의 실이다.&lt;/p>
        &lt;/section>
        &lt;!-- //section05 -->
        
        &lt;section id="section06" class="content__item">
            &lt;span class="content__item__num">06&lt;/span>
            &lt;h2 class="content__item__title">section6&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">기회는 새와 같은 것 날아가기 전에 꼭 잡아야 한다.&lt;/p>
        &lt;/section>
        &lt;!-- //section06 -->
        
        &lt;section id="section07" class="content__item">
            &lt;span class="content__item__num">07&lt;/span>
            &lt;h2 class="content__item__title">section7&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">요구받기 전에 충고하지 말라.&lt;/p>
        &lt;/section>
        &lt;!-- //section07 -->
        
        &lt;section id="section08" class="content__item">
            &lt;span class="content__item__num">08&lt;/span>
            &lt;h2 class="content__item__title">section8&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">오랫동안 꿈을 그리는 사람은 마침내 그 꿈을 닮아간다.&lt;/p>
        &lt;/section>
        &lt;!-- //section08 -->
        
        &lt;section id="section09" class="content__item">
            &lt;span class="content__item__num">09&lt;/span>
            &lt;h2 class="content__item__title">section9&lt;/h2>
            &lt;figure class="content__item__imgWrap">
                &lt;div class="content__item__img">&lt;/div>
            &lt;/figure>
            &lt;p class="content__item__desc">몸가짐은 각자가 자기의 모습을 비추는 거울이다.&lt;/p>
        &lt;/section>
        &lt;!-- //section09 -->
        
    &lt;/div>
&lt;/main>
&lt;!-- main -->

&lt;aside id="parallax__info">
    &lt;div class="scroll">scrollTop : &lt;span>0&lt;/span>px&lt;/div>
    &lt;div class="info">
        &lt;ul>
            &lt;li>section1 offset() : &lt;span class="offset1">0&lt;/span>&lt;/li>
            &lt;li>section2 offset() : &lt;span class="offset2">0&lt;/span>&lt;/li>
            &lt;li>section3 offset() : &lt;span class="offset3">0&lt;/span>&lt;/li>
            &lt;li>section4 offset() : &lt;span class="offset4">0&lt;/span>&lt;/li>
            &lt;li>section5 offset() : &lt;span class="offset5">0&lt;/span>&lt;/li>
            &lt;li>section6 offset() : &lt;span class="offset6">0&lt;/span>&lt;/li>
            &lt;li>section7 offset() : &lt;span class="offset7">0&lt;/span>&lt;/li>
            &lt;li>section8 offset() : &lt;span class="offset8">0&lt;/span>&lt;/li>
            &lt;li>section9 offset() : &lt;span class="offset9">0&lt;/span>&lt;/li>
        &lt;/ul>
    &lt;/div>
&lt;/aside>
</code></pre>
                </div>
            </details>
            <h3 class="t_tit2">스크립트 요약</h3>
            <p class="t_desc">
                1. window.addEventListener("scroll", ()=>{});메서드를 이용해 스크롤 하는 이벤트를 발생시킵니다.<br>
                2. pageYOffset, scrollY, scrollTop 속성을 이용해 변수에 페이지의 스크롤 값을 불러와 저장합니다.<br>
                3. 변수에 페이지의 스크롤 값을 저장합니다.<br>
                4. offsetTop 속성을 이용해 요소의 좌푯값을 구하고, 요소의 좌푯값과 스크롤 값을 비교하여 메뉴 버튼을 활성화합니다.
            </p>
            <details>
                <summary>전체 스크립트 보기</summary>
                <div class="t_code">
<pre><code class="language-js">const scroll = document.querySelector("#parallax__info .scroll span");
window.addEventListener("scroll", ()=>{
    //let scrollTop = window.pageYOffset;
    //let scrollTop = window.scrollY;
    //let document.documentElement.scrollTop;
    let scrollTop = window.pageYOffset || window.scrollY || document.documentElement.scrollTop;
    
    // forEach
    document.querySelectorAll(".content__item").forEach((element, index)=>{
        if(scrollTop >= element.offsetTop -3){
            document.querySelectorAll("#parallax__nav li").forEach(li => {
                li.classList.remove("active");
            });
            document.querySelector("#parallax__nav li:nth-child("+(index+1)+")").classList.add("active");
        }
    });

    //info
    document.querySelector(".scroll span").innerText = Math.round(scrollTop);
    
    for(let i=1; i&lt;=9; i++){
        document.querySelector(".offset"+i).innerText = document.getElementById("section0"+i).offsetTop+"px";
    }
});

//스크롤 이동
document.querySelectorAll("#parallax__nav li a").forEach(li => {
    li.addEventListener("click", (e) => {
        e.preventDefault();
        document.querySelector(li.getAttribute("href")).scrollIntoView({
            behavior: "smooth"
        });
    });
});
</code></pre>
                </div>
            </details>
            <h3 class="t_tit2">스크립트 뜯어보기</h3>
            <p class="t_desc2">
                스크립트를 차근차근 뜯어보며 이해해 봅시다!
            </p>
            <p class="t_desc">
                > 선택자 만들기 : 요소의 offsetTop 값을 구해 삽입할 span태그를 선택하여 scroll 변수 안에 저장합니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">const scroll = document.querySelector("#parallax__info .scroll span")
</code></pre>
            </div>
            <p class="t_desc">
                > 이벤트 메서드 작성하기 : 패럴랙스는 스크롤 이벤트 발생에 따른 애니메이션 효과 등을 말합니다. 화면상에서의 이벤트 발생을 가져오기 위해, 대상 요소는 window로 합니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">window.addEventListener("scroll", ()=>{
    …
});
</code></pre>
            </div>
            <p class="t_desc">
                > 함수 실행문 작성하기 : 스크롤 값(데이터) 불러오기. scrollTop 변수에 페이지의 스크롤 값을 불러와 저장합니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">//let scrollTop = window.pageYOffset;
//let scrollTop = window.scrollY;
//let document.documentElement.scrollTop;
//위의 세가지 코드는 모두 같은 값을 가져옵니다. 대상의 스크롤 값(문서 기준, y좌표값)
//브라우저에서의 호환성을 고려하기 위해, or연산자( || )를 이용해 세가지 모두 작성해줍니다!

let scrollTop = window.pageYOffset || window.scrollY || document.documentElement.scrollTop;
</code></pre>
            </div>
            <p class="t_desc">
                > 함수 실행문 작성하기 : 스크롤 값이 요소의 offset 값보다 크거나 같으면 스크롤이 해당 섹션에 도달하지 못한 것이므로, 메뉴의 클래스에서 active를 삭제합니다.<br>
                 그리고 도달한 요소는 index+1 번째 li요소와 같으므로, 변수를 사용하여 해당 요소를 선택한 후, 클래스에 active를 추가해 활성화 시켜줍니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">document.querySelectorAll(".content__item").forEach((element, index)=>{
    if(scrollTop >= element.offsetTop -3){
        document.querySelectorAll("#parallax__nav li").forEach(li => {
            li.classList.remove("active");
        });
        document.querySelector("#parallax__nav li:nth-child("+(index+1)+")").classList.add("active");
    }
});
</code></pre>
            </div>
            <p class="t_desc">
                > 함수 실행문 작성하기 : 앞서 선택한 span 태그 안에 scrollTop 값과 offsetTop 값을 넣어줍니다. Math.round() 메서드는 값을 반올림하여 줍니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">document.querySelector(".scroll span").innerText = Math.round(scrollTop);

for(let i=1; i&lt;=9; i++){
    document.querySelector(".offset"+i).innerText = document.getElementById("section0"+i).offsetTop+"px";
}
</code></pre>
            </div>
            <p class="t_desc">
                > 메뉴 선택 이동 효과 주기 : 각 메뉴를 클릭했을 때, 해당 섹션으로 이동하도록 하는 스크립트입니다.<br>
                <i>preventDefault()</i> 메서드는 요소를 클릭했을 때, 맨 위로 스크롤되는 이벤트가 발생하지 않도록 합니다.<br>
                <i>scrollIntoView()</i> 메서드는 스크롤이 이동하는 동안의 움직임 효과를 설정할 수 있습니다.
            </p>
            <div class="t_code">
<pre><code class="language-js">document.querySelectorAll("#parallax__nav li a").forEach(li => {
    li.addEventListener("click", (e) => {
        e.preventDefault();
        document.querySelector(li.getAttribute("href")).scrollIntoView({
            behavior: "smooth"
        });
    });
});
</code></pre>
            </div>
            <h3 class="t_tit2">> 완성 페이지 보기</h3>
            <div class="t_iframe" style="min-height: 700px; padding-top: 0;">
                <iframe src="https://hjkang306.github.io/coding2/javascript/effect/parallaxEffect01.html" frameborder="0"></iframe>
            </div>
            <div class="t_link">
                <a href="https://github.com/hjkang306/coding2/blob/main/javascript/effect/parallaxEffect01.html">원본 소스 보기</a>
            </div>
        </div>
    </main>
    <!-- //main -->

    <footer id="footer">
        <a href="mailto:hjkang306@naver.com">hjkang306@naver.com</a>
    </footer>
    <!-- //footer -->

    <script src="../../assets/js/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>

</html>